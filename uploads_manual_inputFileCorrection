<?xml version="1.0" encoding="UTF-8"?>
<config xmlns="http://web-harvest.sourceforge.net/schema/1.0/config" scriptlang="groovy">

 
    
        <script ><![CDATA[
            import java.nio.file.Files
			import org.apache.commons.io.FileUtils;
			import java.io.File;
			import java.io.FileInputStream;
			import java.io.FileOutputStream;
			import java.util.*;
			import java.text.SimpleDateFormat;
		
			import org.apache.poi.xssf.usermodel.*;
			import org.apache.poi.ss.usermodel.*;
			import org.apache.poi.hssf.usermodel.*;
			import java.text.SimpleDateFormat;
			import org.apache.poi.ss.usermodel.DateUtil
			
			import java.io.FileNotFoundException;
			import java.io.FileOutputStream;
			import java.io.IOException;
			
			//TO BE MIGRATED ACCORDINGLY
			def inputExcelPath = "C:\\Users\\NanoBNK\\Desktop\\BARC\\MCIB\\Upload\\MCIB- Manual Run.xlsx";
			List portal_run_list = new ArrayList();
			List teradata_run_list = new ArrayList();
			
			
			/////////////////////////////////GATHER DATA////////////////////////////
			File inputFile1 = null;
			try{
				//FROM
				inputFile1 = new File(inputExcelPath);
				FileInputStream fis1 = new FileInputStream(inputFile1);
				XSSFWorkbook inputWorkbook1 = new XSSFWorkbook(fis1);
				XSSFSheet inputSheet1 = inputWorkbook1.getSheetAt(0); 
								
				int rowCount1 = inputSheet1.getLastRowNum();
				log.info(rowCount1+" rows in inputsheet: "+inputSheet1.getSheetName());
			
				
			    int currentRowIndex1=1;//CHANGE
							               
				Iterator rowIterator1 = inputSheet1.iterator();
				
			while(rowIterator1.hasNext())
			{
		
			
				Row currentRow1 = inputSheet1.getRow(currentRowIndex1);
				
				if(currentRow1 == null){log.info("Brokeman");break;}
				Cell blankCheck1 = currentRow1.getCell(0,Row.MissingCellPolicy.RETURN_BLANK_AS_NULL);
				if(blankCheck1 == null){log.info("Brokeman Cell");break;}
				
						String value = "";
						for(int currentCellIndex1 = 0; currentCellIndex1 < 5; currentCellIndex1++){//0-5-->A-E
							Cell cellData1 = currentRow1.getCell(currentCellIndex1,Row.MissingCellPolicy.RETURN_BLANK_AS_NULL);
							DataFormatter formatter1 = new DataFormatter();
							value1 = formatter1.formatCellValue(cellData1);
							
								switch(currentCellIndex1){
									
									case 1:	//teradata 
										if(value1 == "TRUE"){
											teradata_run_list.add(currentRowIndex1);
											break;
										}
									
									case 2://mcib portal
										if(value1 == "TRUE"){
											portal_run_list.add(currentRowIndex1);
											break;
										}	
								}
								
						}
						currentRowIndex1++;
						
					
				
							
			}
			inputWorkbook1.close();
			fis1.close();
		
			
			}catch(Exception e){
			log.info("Error reading input file");
			e.printStackTrace();} 
			
			println("TERA: "+teradata_run_list);
			println("Portail du Mage: "+portal_run_list);
			
			
			/////////////////////////////////GATHER DATA////////////////////////////
			
			
        ]]></script>
   
     
  
     

<export include-original-data="true">


        
</export>

</config>
